<!doctype html><html prefix="og: http://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>A quick look at HTMX &#183;</title><meta name=description content="SPA's are going out of style"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=generator content="Hugo 0.110.0"><meta name=robots content="index,follow"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="A quick look at HTMX"><meta property="og:description" content="SPA's are going out of style"><meta property="og:type" content="article"><meta property="og:url" content="/a-quick-look-at-htmx/"><link rel=stylesheet href=/dist/site.css><link rel=stylesheet href=/dist/syntax.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css integrity=sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN crossorigin=anonymous></head><body><div id=wrapper><header class=site-header><div class=container><div class=site-title-wrapper><h1 class=site-title><a href=/>Torbjörn Molin - Blog</a></h1><a class="button-square button-social hint--top" data-hint=Github aria-label=Github href=https://github.com/torbjornmolin rel=me><i class="fa fa-github-alt" aria-hidden=true></i></a>
<a class="button-square button-social hint--top" data-hint=Email aria-label="Send an Email" href=mailto:konsult@torbjornmolin.se><i class="fa fa-envelope" aria-hidden=true></i></a></div><ul class=site-nav><li class=site-nav-item><a href=/>Blog</a></li><li class=site-nav-item><a href=/page/about/>About</a></li></ul></div></header><div id=container><div class=container><article class=post-container itemscope itemtype=http://schema.org/BlogPosting><header class=post-header><h1 class=post-title itemprop="name headline">A quick look at HTMX</h1><p class=post-description itemprop=description>SPA's are going out of style</p><p class="post-date post-line"><span>Published <time datetime=2022-10-16 itemprop=datePublished>Sun, Oct 16, 2022</time></span>
<span>by</span>
<span itemscope itemprop=author itemtype=https://schema.org/Person><span itemprop=name><a href=# itemprop=url rel=author>Torbjörn Molin</a></span></span></p></header><div class="post-content clearfix" itemprop=articleBody><h2 id=the-times-they-are-a-changing>The times they are a-changing</h2><p>There are trends in everything and tech stacks, programming languages and frameworks are certainly no exception, quite the opposite. Recently one of the technologies that has fallen out of favor the people that like to tell the internet what&rsquo;s hot is SPA applications and client side rendered pages in general.</p><p>Thoughtworks added <a href=https://www.thoughtworks.com/radar/techniques/spa-by-default>&ldquo;SPA by default&rdquo;</a> to their hold list in march of 2022 on the grounds that teams have stoped contemplating that going with a SPA is even a choice in the first place. They also list many of the complexities that come with SPA applications, again noting that the complexity might be warranted but needs to be taken on as an active decision.</p><p>One alternative that seems to come up a lot lately is <a href=https://htmx.org>htmx</a>, a small Javascript library that enables HTML elements to dynamically update their content from a server resource in response to events. There is one <a href=https://htmx.org/essays/a-real-world-react-to-htmx-port/>case study</a> available on their site that shows how replacing React with HTMX reduced total code base size by 67% and page load times by 50-60%.</p><p>Being mainly a backend developer who also often has to do frontend (I guess that makes me full stack?), writing less Javascript sounds like an appealing proposal so I thought I&rsquo;d do a quick small project just to see what HTMX is like.</p><h2 id=what-to-build>What to build</h2><p>I&rsquo;d like to get this done in an afternoon, so it will have to be something small. I&rsquo;ll build a calculator that helps the user figure out how to distribute income in a typical Swedish freelancer one person limited company. The input will be hourly rate and perhaps expected number of days billed per year. Just so that the demo keeps some server side state, the user is able to save the result of the calculation and the ten last saved calculations are displayed on the page.</p><p>I&rsquo;ll build this as a ASP.NET Core web api that also servers a static page that is the application.</p><h2 id=lets-get-started>Let&rsquo;s get started</h2><p>To get started, we create a new web api project and add a folder for static pages to it.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir htmx_test
</span></span><span style=display:flex><span>cd htmx_test
</span></span><span style=display:flex><span>dotnet new webapi
</span></span><span style=display:flex><span>mkdir wwwroot
</span></span></code></pre></div><p>The wwwroot folder is the default content folder for an ASP.NET project, but no static content is served from it by default in a web api project, so we need to enable it. To do so, we simply add a line to the default <code>Program.cs</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>app.UseStaticFiles();
</span></span></code></pre></div><p>We&rsquo;ll also create a basic index.html and add it to <code>wwwroot</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span> /&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width&#34;</span> /&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>title</span>&gt;Freelance calculator&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;description&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Freelance calculator.&#34;</span> /&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;author&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Torbjörn Molin&#34;</span> /&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>header</span>&gt;Freelance calculator&lt;/<span style=color:#f92672>header</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>h1</span>&gt;Calculator&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>p</span>&gt;This is the calculator&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>hx-get</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/calculator/history&#34;</span> <span style=color:#a6e22e>hx-trigger</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;every 2s&#34;</span>&gt;Initial&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><p>Now when we run the project with <code>dotnet run</code> and open <code>http://localhost:&lt;port>/index.html</code> we should see our page.
<img src=/htmx-start-webpage.png alt="static site">
Now that we&rsquo;ve set up the project we can start having a go at creating our small app with htmx. We start by adding htmx to our site</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://unpkg.com/htmx.org@1.8.2&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>You can also download <code>htmx.min.js</code> and keep it in <code>wwwroot</code> and reference that, if you like.</p><p>Now that we&rsquo;ve added htmx, let&rsquo;s create some dynamic content. We start by renaming the default <code>WeatherController</code> to <code>CalculatorController</code>. We also delete most of the boilerplate code and add a method that will respond to the route <code>&lt;baseurl>/calculator/history</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>using</span> Microsoft.AspNetCore.Mvc;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> htmx_test.Controllers;
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>[ApiController]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>[Route(&#34;[controller]</span><span style=color:#e6db74>&#34;)]
</span></span></span><span style=display:flex><span><span style=color:#e6db74></span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>CalculatorController</span> : ControllerBase
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>readonly</span> ILogger&lt;CalculatorController&gt; _logger;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> CalculatorController(ILogger&lt;CalculatorController&gt; logger)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        _logger = logger;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span><span style=color:#a6e22e>
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>    [HttpGet(&#34;history&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> GetHistory()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>$&#34;history, {DateTime.Now.Second}&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We then change our history div in <code>index.html</code> to</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>hx-get</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/calculator/history&#34;</span> <span style=color:#a6e22e>hx-trigger</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;every 2s&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span></code></pre></div><p>The page now polls our endpoint every two seconds and replaces the content of our div with whatever html is returned.
<img src=/htmx-dynamic-history.png alt="dynamic history">
Pretty cool! But not very useful yet. Let&rsquo;s add a get method to <code>CalculatorController</code> that for an input of hourly rate and number of vacation days returns how much is left after expenses are paid.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#a6e22e>    [HttpGet(Name = &#34;Calculator&#34;)]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> GetCalculator(<span style=color:#66d9ef>int</span> rate, <span style=color:#66d9ef>int</span> vacationDays)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> calculatorResult = <span style=color:#66d9ef>new</span> FreelanceCalculator().Calculate(rate, vacationDays);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> sb = <span style=color:#66d9ef>new</span> StringBuilder();
</span></span><span style=display:flex><span>        sb.Append(<span style=color:#e6db74>$&#34;&lt;p&gt;Total salary cost: {calculatorResult.SalaryExpense}&lt;/p&gt;&#34;</span>);
</span></span><span style=display:flex><span>        sb.Append(<span style=color:#e6db74>$&#34;&lt;p&gt;Pension cost {calculatorResult.Pension}&lt;/p&gt;&#34;</span>);
</span></span><span style=display:flex><span>        sb.Append(<span style=color:#e6db74>$&#34;&lt;p&gt;Remaining: {calculatorResult.Remaining}&lt;/p&gt;&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> sb.ToString();
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>The <code>Calculate</code> method of <code>FreelanceCalculator</code> is not that important here, but it returns a <code>FreelanceCalculatorResult</code> with three integers that are used by <code>GetCalculator</code>.</p><p>We also make some updates to <code>index.html</code> to use the new endpoint:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span> /&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width&#34;</span> /&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>title</span>&gt;Freelance calculator&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;description&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Freelance calculator.&#34;</span> /&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;author&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Torbjörn Molin&#34;</span> /&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;htmx.min.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>header</span>&gt;Freelance calculator&lt;/<span style=color:#f92672>header</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>hx-get</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/Calculator&#34;</span> <span style=color:#a6e22e>hx-target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#result&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;number&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;rate&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;850&#34;</span> /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;number&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;vacationDays&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;30&#34;</span> /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;Calculate&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;result&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>hx-get</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/calculator/history&#34;</span> <span style=color:#a6e22e>hx-trigger</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;every 2s&#34;</span>&gt;Initial&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><p>The top div gets a form with two number inputs. <code>hx-get</code> tells htmx which endpoint to use and <code>hx-target</code> specifies that the result should be loaded in the div with id <code>result</code>.</p><p>We now have an actual interactive page:</p><p><img src=/htmx-first-calculator.png alt="a working calculator"></p><p>Let&rsquo;s make the history section display something useful as well. We&rsquo;ll do it very quick and dirty and non-thread safe and just keep a static <code>Queue&lt;FreelanceCalculatorResult></code> in the controller, add the result of the calculations to that every time and remove entries if we have more than ten.</p><p>In <code>CalculatorController</code> we add</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>readonly</span> Queue&lt;FreelanceCalculatorResult&gt; freelanceCalculatorResults = <span style=color:#66d9ef>new</span> Queue&lt;FreelanceCalculatorResult&gt;();
</span></span></code></pre></div><p><code>GetHistory()</code> gets changed to</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#a6e22e>    [HttpGet(&#34;history&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>string</span> GetHistory()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (freelanceCalculatorResults.Count == <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;No history yet&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> sb = <span style=color:#66d9ef>new</span> StringBuilder();
</span></span><span style=display:flex><span>        sb.Append(<span style=color:#e6db74>&#34;&lt;ul&gt;&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> result <span style=color:#66d9ef>in</span> freelanceCalculatorResults.AsEnumerable().Reverse())
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            sb.Append(<span style=color:#e6db74>$&#34;&lt;li&gt;Rate: {result.Rate} Vacation days: {result.VacationDays} Amount left: {result.Remaining}&lt;/li&gt;&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        sb.Append(<span style=color:#e6db74>&#34;&lt;/ul&gt;&#34;</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> sb.ToString();
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>and in <code>GetCalculator</code> we add</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>        freelanceCalculatorResults.Enqueue(calculatorResult);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (freelanceCalculatorResults.Count &gt; <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>            freelanceCalculatorResults.Dequeue();
</span></span></code></pre></div><p><img src=/htmx-calculator-with-history.png alt="calculator with history"></p><p>Finally, we probably should have the history div load when the page loads and whenever we submit a new calculation instead of polling every two seconds. To accomplish that, assign an id to the button. Like <code>id="submit-button"</code> for example, and change the <code>hx-trigger</code> of the history div to <code>hx-trigger="load, click from:#submit-button"</code>. This tells htmx to listen to the <code>load</code> event and also to the <code>click</code> event from the html-element with id <code>submit-button</code> and voilà, we have the behavior that we&rsquo;re after.</p><p>The full html that we end up with looks something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE html&gt;</span>
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>html</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;en&#34;</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>charset</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span> /&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width&#34;</span> /&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>title</span>&gt;Freelance calculator&lt;/<span style=color:#f92672>title</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;description&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Freelance calculator.&#34;</span> /&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;author&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Torbjörn Molin&#34;</span> /&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;htmx.min.js&#34;</span>&gt;&lt;/<span style=color:#f92672>script</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>head</span>&gt;
</span></span><span style=display:flex><span>  &lt;<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>header</span>&gt;Freelance calculator&lt;/<span style=color:#f92672>header</span>&gt;
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>hx-get</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/Calculator&#34;</span> <span style=color:#a6e22e>hx-target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#result&#34;</span>&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;number&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;rate&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;850&#34;</span> /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;number&#34;</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;vacationDays&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;30&#34;</span> /&gt;
</span></span><span style=display:flex><span>        &lt;<span style=color:#f92672>button</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit-button&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span>&gt;Calculate&lt;/<span style=color:#f92672>button</span>&gt;
</span></span><span style=display:flex><span>      &lt;/<span style=color:#f92672>form</span>&gt;
</span></span><span style=display:flex><span>      &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;result&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    &lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>    History
</span></span><span style=display:flex><span>    &lt;<span style=color:#f92672>div</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>hx-get</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/calculator/history&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>hx-trigger</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;load, click from:#submit-button&#34;</span>
</span></span><span style=display:flex><span>    &gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span><span style=display:flex><span>  &lt;/<span style=color:#f92672>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>html</span>&gt;
</span></span></code></pre></div><h2 id=final-thoughts>Final thoughts</h2><p>Even though this was a simple hello world type example, I&rsquo;m kind of impressed with how easy it was. The features that htmx provide really do go a long way with very little effort and since the concepts introduced are so few and simple I didn&rsquo;t have to read a lot of documentation to figure out what to do. Around ten minutes of reading was probably all I had to do.</p><p>I guess that some sort of template engine to handle the HTML snippets in the backend would be nice to have for a real world project, but if you have that htmx will probably give many projects most if not all of what is needed for very little effort compared to the big Javascript frameworks.</p><p>If you want to look at the very hacky code, it&rsquo;s available on <a href=https://github.com/torbjornmolin/htmx_test>Github</a></p></div><footer class="post-footer clearfix"><div class=share><a class=icon-twitter href="https://twitter.com/share?text=A%20quick%20look%20at%20HTMX&url=%2fa-quick-look-at-htmx%2f" onclick='return window.open(this.href,"twitter-share","width=550,height=235"),!1' aria-label="Share on Twitter"><i class="fa fa-twitter" aria-hidden=true></i></a></div></footer></article></div></div></div><footer class=footer><div class=container><div class=site-title-wrapper><h1 class=site-title><a href=/>Torbjörn Molin - Blog</a></h1><a class="button-square button-jump-top js-jump-top" href=# aria-label="Back to Top"><i class="fa fa-angle-up" aria-hidden=true></i></a></div><p class=footer-copyright><span>&copy; 2022 / Powered by <a href=https://gohugo.io/>Hugo</a></span></p><p class=footer-copyright><span><a href=https://github.com/roryg/ghostwriter>Ghostwriter theme</a> By <a href=http://jollygoodthemes.com>JollyGoodThemes</a></span>
<span>/ <a href=https://github.com/jbub/ghostwriter>Ported</a> to Hugo By <a href=https://github.com/jbub>jbub</a></span></p></div></footer><script src=/js/jquery-1.11.3.min.js></script>
<script src=/js/jquery.fitvids.js></script>
<script src=/js/scripts.js></script></body></html>